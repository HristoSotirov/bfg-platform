server:
  port: ${SERVER_PORT:8080}
  shutdown: graceful

spring:
  application:
    name: bfg-platform
  lifecycle:
    timeout-per-shutdown-phase: 10s
  datasource:
    # Local development defaults - override with DATABASE_URL, DATABASE_USERNAME, DATABASE_PASSWORD env vars for production
    url: ${DATABASE_URL:jdbc:postgresql://localhost:5434/bfg_platform?options=-c%20timezone=UTC}
    username: ${DATABASE_USERNAME:bfg_user}
    password: ${DATABASE_PASSWORD:bfg_password}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: ${JPA_SHOW_SQL:true}
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: ${JPA_FORMAT_SQL:true}
  liquibase:
    change-log: classpath:db/changelog/db.changelog-master.yaml
    enabled: true
    drop-first: ${LIQUIBASE_DROP_FIRST:true}
    clear-checksums: ${LIQUIBASE_CLEAR_CHECKSUMS:true}

jwt:
  issuer: ${JWT_ISSUER:bfg-platform}
  audience: ${JWT_AUDIENCE:bfg-platform}
  # Production defaults: 15 minutes access token, 7 days refresh token
  # Override with JWT_ACCESS_TTL_SECONDS and JWT_REFRESH_TTL_SECONDS env vars for local testing (e.g., 86400 for 24-hour access tokens)
  access-token-ttl-seconds: ${JWT_ACCESS_TTL_SECONDS:900} # 15 minutes (production default)
  refresh-token-ttl-seconds: ${JWT_REFRESH_TTL_SECONDS:604800} # 7 days (production default)
  private-key-pem: ${JWT_PRIVATE_KEY_PEM:}
  public-key-pem: ${JWT_PUBLIC_KEY_PEM:}
  # Allow ephemeral keys for local development when JWT keys are not provided
  # In production, always set JWT_PRIVATE_KEY_PEM and JWT_PUBLIC_KEY_PEM
  allow-ephemeral-keys: ${JWT_ALLOW_EPHEMERAL_KEYS:true}

springdoc:
  api-docs:
    enabled: ${SWAGGER_ENABLED:true}
    path: /api-docs
  swagger-ui:
    enabled: ${SWAGGER_ENABLED:true}
    path: /swagger-ui.html
    url: /openapi/openapi.yaml

# Bootstrap configuration - creates first APP_ADMIN automatically if none exists
# For production, set BOOTSTRAP_TOKEN, BOOTSTRAP_ADMIN_USERNAME, BOOTSTRAP_ADMIN_PASSWORD env vars
bfg:
  bootstrap:
    token: ${BOOTSTRAP_TOKEN:local-dev}
    admin:
      username: ${BOOTSTRAP_ADMIN_USERNAME:admin}
      password: ${BOOTSTRAP_ADMIN_PASSWORD:admin123}
      first-name: ${BOOTSTRAP_ADMIN_FIRST_NAME:App}
      last-name: ${BOOTSTRAP_ADMIN_LAST_NAME:Admin}
  # Test data bootstrap - set to true to enable test data loading
  # Or use --spring.profiles.active=local
  test-data:
    enabled: ${BFG_TEST_DATA_ENABLED:false}

# S3/MinIO configuration - local development defaults
# For production, set S3_ENDPOINT, S3_ACCESS_KEY, S3_SECRET_KEY env vars
s3:
  endpoint: ${S3_ENDPOINT:http://localhost:9000}
  access-key: ${S3_ACCESS_KEY:minioadmin}
  secret-key: ${S3_SECRET_KEY:minioadmin}
  bucket-name: ${S3_BUCKET_NAME:bfg-platform-photos}
  region: ${S3_REGION:us-east-1}

# Logging configuration - enhanced for local development
# For production, set LOG_LEVEL_* env vars to reduce verbosity
logging:
  level:
    root: ${LOG_LEVEL_ROOT:INFO}
    com.bfg.platform: ${LOG_LEVEL_PLATFORM:DEBUG}
    org.springframework.web: ${LOG_LEVEL_WEB:INFO}
    org.hibernate.SQL: ${LOG_LEVEL_SQL:DEBUG}
    org.hibernate.type.descriptor.sql.BasicBinder: ${LOG_LEVEL_SQL_BINDER:TRACE}
